<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
    <title>股票分析</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/BeatPicker.min.css"/>
    <link rel="stylesheet" href="documents/css/demos.css"/>
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/BeatPicker.min.js"></script>
</head>
<body>
	<div class="container">
	<div class="row">
		<div class="inputtime col-md-6 col-md-offset-3 col-xs-6 col-xs-offset-3  col-sm-6 col-sm-offset-3">
			<h1>股票分析</h1>
		</div>
	</div>
	<form action="#" method="get">
		<div class="row">
			<div class="inputtime col-md-6 col-md-offset-3 col-xs-6 col-xs-offset-3  col-sm-6 col-sm-offset-3">
					<div class="inputname">请输入起始时间</div>
			        <input id="starttime" type="text" name="starttime" data-beatpicker="true"/>
			</div>
		</div>
		<div class="row">
			<div class="inputtime col-md-6 col-md-offset-3 col-xs-6 col-xs-offset-3 col-sm-6 col-sm-offset-3">
					<div class="inputname">请输入截止时间</div>
			        <input id="endtime" type="text" name="endtime" data-beatpicker="true"/>
			</div>
		</div>
		<div class="row">
			<div id="earlytime"></div>
			<div id="lasttime"></div>
		</div>
	</form>
	<form id="size" class="row">
				全选：<input name="sanyi" type="radio" value="1" />
				三亿以上：<input name="sanyi" type="radio" value="2" />
		</form>
	<button id="btn2">click</button><br>
	<button>一个不中</button>
	<input type="text" id="no_one" disabled="true"><br>
	<button>至少一个</button>
	<input type="text" id="at_least" disabled="true"><br>
	<button>只中一个</button>
	<input type="text" id="only_one" disabled="true"><br>
	<button>至少两个</button>
	<input type="text" id="least_two" disabled="true"><br>
<br>
	<input type="button" value="Ajax提交" onclick="Ajax();" />
	<table>
		<div id="disp">
		</div>
	</table>
	
	</div>
	  
</body>
<script>
	function getRadioBoxValue() 
	{ 
		var obj = document.getElementById("size").sanyi;
        for(i=0; i<obj.length;i++){
			if(obj[i].checked){ 
                return obj[i].value; 
                } 
            }
            return "0" ;               
	}	
	var dataList = [];
	var e_stime = 0;
	var e_etime = 0;
	var last_time = document.getElementById("lasttime");
	var early_time = document.getElementById("earlytime");
	var starttime = document.getElementById("starttime");
	var endtime = document.getElementById("endtime");
	var btn2=document.getElementById('btn2');
	var no_one=document.getElementById('no_one');
	var at_least=document.getElementById('at_least');
	var only_one=document.getElementById('only_one');
	var least_two=document.getElementById('least_two');

    var Ajax = function ()  
    {  
        $.getJSON ("js/dataa.json?"+Math.random(), function (data)  
        {  $("#disp").append("<tr><td>股票名称</td><td>代码号</td><td>数量</td><td>最大</td><td>时间</td><td>中签率</td></tr>");
        	early_time=last_time=data[0].date;
            $.each (data, function (i, item)  
            {  
            	if(item.date>last_time){
            		last_time=item.date
            	}else if(item.date<early_time){
            		early_time=item.date;
            	};
                if(item.date>=e_stime&&item.date<=e_etime){
                $ ("#disp").append ("<tr><td>" + item.name +"</td><td>"+ item.num +"</td><td>"+ item.size +"</td><td>"+ item.max +"</td><td>"+ item.date +"</td><td>"+ item.rate + "</td></tr>");	
                dataList.push(item.rate);}
            });

        }); 
    } 
	btn2.onclick=function(){
		// alert(getRadioBoxValue());
		no_one_at_least();
		only_one_value();
		at_least_two();
		checkTime();

	}
	function no_one_at_least(){
		let base = 1;
		dataList.forEach(function(item){
			base *= (1-item);
		});
		no_one.value = base;
		count0 = base;
		at_least.value = 1 - base;

	}
	function only_one_value(){
		let base;
		let last = 0;
		for(let i=0;i<dataList.length;i++){
			base = 1;
			for(let j=0;j<dataList.length;j++){
				if(i==j){continue;}
				base*=(1-dataList[j]);
			}
			last += (dataList[i]*base);

		}
		only_one.value = last;
		count1 = last;
	}
	function at_least_two(){
		least_two.value = 1-(count0+count1);
		count2 = 1-(count0+count1);
	}
	function checkTime(){
		var starttime_val = starttime.value;
		var endtime_val = endtime.value;
			if(starttime_val==""||starttime_val==null)
			{
				alert("请输入起始时间！");
			}
			else if(endtime_val==""||endtime_val==null)
			{
				alert("请输入截止时间！");
			}
			else if(starttime_val>endtime_val)
			{
				alert("起始时间必须小于截止时间！");
			}else{
				e_stime=starttime_val.replace(/-/g,'');
				e_etime=endtime_val.replace(/-/g,'');
			}
		}
		
	
</script>
<style>
#disp tr td{
	border: 1px solid #000;
	height: 10px;
	padding: 5px;
}
</style>
</html>